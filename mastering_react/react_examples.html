<!DOCTYPE html>
<html>
<head>
        <link rel="stylesheet" type='text/css' href="style.css">
        <script src="https://fb.me/react-0.14.3.js"></script>
        <script src="https://fb.me/react-dom-0.14.3.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.34/browser.js"></script>
        <script src='https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.34/browser.js'> </script>
        <!-- This is not recommanded for productin websites -->
        <!-- We will use webpack for serious work-->
  <title> Nailing React </title>
</head>
<body>
  <div id='h'> </div>
  <script type='text/babel'>
  let Note = React.createClass({
    getInitialState(){
      return {editing: false} // when the app is loaded, we want the main form
    },
    edit(){
      this.setState({editing : true}) //  when we click on ediiti, make it true , to run the Form
    },
    save(){  // this is actually a button that can put us back to the main form after savin
      let val = this.refs.NewText.value;
      this.props.updatenotetext(val,this.props.index)
      this.setState({editing: false})    
    },
      renderForm(){
        return (
          <div className="note">
        <textarea ref="NewText"></textarea>
        <button onClick={this.save}> save </button>
        </div>
      )
    },
    renderDisplay(){
      return (
      <div className='note'>
      <span>
      <button onClick={this.edit}> Edtit </button>
      <button onClick={this.remove}> X </button>
      </span>
      <p>{this.props.children}</p>
      </div>
    )
  },
    remove(){
      this.props.deleteNote(this.props.index);
    },
    render(){
      return (this.state.editing) ? this.renderForm() : this.renderDisplay()
      
    }
  })
  
  let Board = React.createClass({
    propTypes: {
      count: function(props, propName){
        if (typeof props[propName] !== 'number') {
          return new Error('Must be a numner. This is not allowed: '+props[propName]);
      
        } if (props[propName]> 100) {
          return new Error('Must be < 100. This number is big: '+props[propName]);
        
        }
      }
    },
    removeNote(i){
      let arr = this.state.Notes;
      arr.splice(i,1);
      this.setState({Notes: arr}) 
    },
    updateNote(NewText, i) {
      let arr = this.state.Notes; 
      arr[i]=NewText;
      this.setState({Notes: arr}) 
    },
    getInitialState(){
      return {
         Notes: ['']
      }
    },
  callback: function(note,i){
      return <Note key={i} index={i} updatenotetext={this.updateNote} deleteNote={this.removeNote}>
      {note}
      </Note>
    }, 
    addN(text){
      let addDynamically = this.state.Notes; 
      addDynamically.push(text);
      this.setState({Notes:addDynamically});
    },
    render(){
      
      return (

        <div>
              <div className='board'>
              <button onClick={this.addN.bind(null,'Add Note')}> Add ME </button>

          {this.state.Notes.map(this.callback)}
        </div>
        </div>
      )
    }
  });
  // props are very powerful, they
  ReactDOM.render(
    
    <Board count={10}></Board>
      ,document.getElementById('h'))
  </script>
</body>
</html> 